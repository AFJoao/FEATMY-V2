<div class="student-detail-page" style="font-family: 'DM Sans', system-ui, sans-serif; background: #FFFFFF; min-height: 100vh;">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700;800&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/mobile-responsive-fixes.css">

  <style>
    .nav-link { color: rgba(255,255,255,0.75); font-weight: 500; font-size: 0.875rem; padding: 8px 16px; border-radius: 8px; border: 1px solid transparent; transition: all 0.2s ease; display: flex; align-items: center; gap: 7px; text-decoration: none; white-space: nowrap; cursor: pointer; background: transparent; }
    .nav-link:hover { color: #fff; background: rgba(255,255,255,0.09); border-color: rgba(255,255,255,0.15); }
    .nav-link-accent { background: #00E676; color: #0A0A0A; font-weight: 700; padding: 8px 18px; border-radius: 8px; font-size: 0.875rem; transition: all 0.2s ease; display: flex; align-items: center; gap: 7px; text-decoration: none; white-space: nowrap; border: none; cursor: pointer; font-family: inherit; }
    .nav-link-accent:hover { background: #00C853; box-shadow: 0 4px 16px rgba(0,230,118,0.3); }
    .workout-card { background: #fff; border: 1px solid #EBEBEB; border-radius: 16px; transition: all 0.25s cubic-bezier(0.4,0,0.2,1); overflow: hidden; }
    .workout-card:hover { border-color: #00E676; transform: translateY(-2px); box-shadow: 0 12px 32px rgba(0,0,0,0.08); }
    .day-badge { padding: 4px 10px; border-radius: 6px; font-size: 0.72rem; font-weight: 700; background: #F4F4F4; color: #374151; }
    .spinner { width: 28px; height: 28px; border: 3px solid rgba(0,0,0,0.08); border-top-color: #00E676; border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .stat-box { background: #F8F9FA; border-radius: 12px; padding: 16px 18px; }
  </style>

  <!-- HEADER -->
  <header style="background: #0A0A0A; position: sticky; top: 0; z-index: 50; border-bottom: 1px solid rgba(255,255,255,0.06);">
    <div style="max-width: 1400px; margin: 0 auto; padding: 0 32px; height: 64px; display: flex; justify-content: space-between; align-items: center;">
      <div style="display: flex; align-items: center; gap: 14px;">
        <button onclick="router.goToPersonalDashboard()" class="nav-link" style="padding: 8px 10px;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="15 18 9 12 15 6"/></svg>
        </button>
        <div style="width: 1px; height: 24px; background: rgba(255,255,255,0.1);"></div>
        <img src="assets/branca_larga.png" alt="Featym" style="height: 26px; object-fit: contain;" onerror="this.style.display='none'">
      </div>
      <nav style="display: flex; align-items: center; gap: 6px;">
        <a href="#/personal/create-workout" class="nav-link-accent">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
          Novo Treino
        </a>
        <a href="#/personal/feedbacks" class="nav-link">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          Feedbacks
        </a>
        <button id="logoutBtn" class="nav-link" style="border: 1px solid rgba(255,255,255,0.14);">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
          Sair
        </button>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main style="max-width: 1200px; margin: 0 auto; padding: 40px 32px 60px;">

    <!-- Student Profile -->
    <div style="background: #0A0A0A; border-radius: 20px; padding: 32px; margin-bottom: 32px; position: relative; overflow: hidden;">
      <div style="position: absolute; inset: 0; background: radial-gradient(ellipse at 80% 50%, rgba(0,230,118,0.06) 0%, transparent 60%); pointer-events: none;"></div>
      <div style="position: relative; display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
        <div id="studentAvatar" style="width: 60px; height: 60px; background: rgba(0,230,118,0.15); border-radius: 16px; display: flex; align-items: center; justify-content: center; border: 1px solid rgba(0,230,118,0.25); flex-shrink: 0;">
          <span id="avatarInitials" style="color: #00E676; font-size: 1.3rem; font-weight: 800;">—</span>
        </div>
        <div style="flex: 1; min-width: 0;">
          <p style="color: rgba(255,255,255,0.4); font-size: 0.72rem; font-weight: 700; letter-spacing: 0.08em; text-transform: uppercase; margin: 0 0 4px;">PERFIL DO ALUNO</p>
          <h1 id="studentName" style="color: #fff; font-size: 1.6rem; font-weight: 800; margin: 0 0 4px; letter-spacing: -0.03em;">Carregando...</h1>
          <p id="studentEmail" style="color: rgba(255,255,255,0.4); font-size: 0.875rem; margin: 0;"></p>
        </div>
        <div style="display: flex; gap: 12px; flex-wrap: wrap;">
          <div class="stat-box" style="background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1);">
            <p style="color: rgba(255,255,255,0.4); font-size: 0.68rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 4px;">Treinos</p>
            <p id="workoutsCount" style="color: #fff; font-size: 1.5rem; font-weight: 800; margin: 0; letter-spacing: -0.03em;">—</p>
          </div>
          <div class="stat-box" style="background: rgba(0,230,118,0.1); border: 1px solid rgba(0,230,118,0.2);">
            <p style="color: rgba(0,230,118,0.6); font-size: 0.68rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 4px;">Status</p>
            <p style="color: #00E676; font-size: 0.9rem; font-weight: 700; margin: 0;">Ativo ●</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Workouts Section -->
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
      <h2 style="font-size: 1.25rem; font-weight: 700; color: #0A0A0A; margin: 0; letter-spacing: -0.02em;">Treinos do Aluno</h2>
      <a href="#/personal/create-workout" class="nav-link-accent" style="font-size: 0.8rem; padding: 8px 16px;">
        <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        Criar Treino
      </a>
    </div>

    <div id="workoutsList" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px;">
      <div style="grid-column:1/-1;text-align:center;padding:64px 20px;">
        <div class="spinner" style="margin:0 auto 16px;"></div>
        <p style="color:#9CA3AF;font-size:0.875rem;margin:0;">Carregando treinos...</p>
      </div>
    </div>

  </main>
</div>

<script>
(function() {
  const dayColors = { 'Segunda': '#DBEAFE', 'Terça': '#EDE9FE', 'Quarta': '#D1FAE5', 'Quinta': '#FEF3C7', 'Sexta': '#FCE7F3', 'Sábado': '#FFF7ED', 'Domingo': '#FEE2E2' };
  const dayText = { 'Segunda': '#1E40AF', 'Terça': '#5B21B6', 'Quarta': '#065F46', 'Quinta': '#92400E', 'Sexta': '#9D174D', 'Sábado': '#9A3412', 'Domingo': '#991B1B' };

  document.getElementById('logoutBtn').onclick = async () => { await authManager.logout(); router.goToLogin(); };

  // Get studentId from route
  const studentId = router.getCurrentStudentId ? router.getCurrentStudentId() : (window.location.hash.split('/').pop() || '');

  async function loadStudent() {
    try {
      const student = await dbManager.getStudentById(studentId);
      if (!student) return;
      const initials = (student.name || 'A').split(' ').map(n => n[0]).join('').slice(0, 2).toUpperCase();
      document.getElementById('avatarInitials').textContent = initials;
      document.getElementById('studentName').textContent = student.name;
      document.getElementById('studentEmail').textContent = student.email;
    } catch(e) {}
  }

  async function loadWorkouts() {
    const list = document.getElementById('workoutsList');
    try {
      const workouts = await dbManager.getStudentWorkouts(studentId) || [];
      document.getElementById('workoutsCount').textContent = workouts.length;

      if (workouts.length === 0) {
        list.innerHTML = `
          <div style="grid-column:1/-1;padding:48px 32px;background:#FAFAFA;border-radius:16px;border:2px dashed #E5E7EB;text-align:center;">
            <p style="font-size:1rem;font-weight:600;color:#374151;margin:0 0 6px;">Nenhum treino cadastrado</p>
            <p style="font-size:0.85rem;color:#9CA3AF;margin:0 0 16px;">Crie o primeiro treino para este aluno</p>
            <a href="#/personal/create-workout" class="nav-link-accent" style="display:inline-flex;font-size:0.8rem;padding:8px 18px;">
              <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
              Criar Treino
            </a>
          </div>`;
        return;
      }

      list.innerHTML = '';
      workouts.forEach(w => {
        const card = document.createElement('div');
        card.className = 'workout-card';
        const days = (w.days || []).slice(0, 4);
        const moreDays = (w.days || []).length - 4;
        card.innerHTML = `
          <div style="padding:20px 20px 16px;">
            <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px;">
              <h3 style="font-size:0.95rem;font-weight:700;color:#0A0A0A;margin:0;line-height:1.4;flex:1;">${w.name}</h3>
            </div>
            <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:14px;">
              ${days.map(d => `<span class="day-badge" style="background:${dayColors[d]||'#F4F4F4'};color:${dayText[d]||'#374151'};">${d.slice(0,3)}</span>`).join('')}
              ${moreDays > 0 ? `<span class="day-badge">+${moreDays}</span>` : ''}
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <span style="font-size:0.78rem;color:#9CA3AF;">${(w.exercises||[]).length} exercício${(w.exercises||[]).length !== 1 ? 's' : ''}</span>
              <button onclick="router.goTo('/personal/workout/${w.id}')" style="background:#F4F4F4;border:none;padding:7px 14px;border-radius:8px;font-size:0.78rem;font-weight:600;color:#374151;cursor:pointer;transition:all 0.2s;font-family:inherit;" onmouseover="this.style.background='#EBEBEB'" onmouseout="this.style.background='#F4F4F4'">Ver detalhes →</button>
            </div>
          </div>`;
        list.appendChild(card);
      });
    } catch(e) {
      list.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:48px;"><p style="color:#BE123C;">Erro ao carregar treinos.</p></div>`;
    }
  }

  loadStudent();
  loadWorkouts();
})();
</script>
